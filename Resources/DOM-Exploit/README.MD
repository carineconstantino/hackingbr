## Sources
É uma propriedade do Javascript que aceita/recebe input de dados. 
```
document.URL
document.documentURI
document.URLUnencoded
document.baseURI
location
document.cookie
document.referrer
window.name
history.pushState
history.replaceState
localStorage
sessionStorage
IndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)
Database
```

## Sink
É uma função do Javascript ou um objeto DOM. A vulnerabilidade DOM ocorre quando um input é enviado do Source para o Sink e é executado de forma insegura. 
```
document.write()
window.location
document.cookie
eval()
document.domain
WebSocket()
element.src
postMessage()
setRequestHeader()
FileReader.readAsText()
ExecuteSql()
sessionStorage.setItem()
document.evaluate()
JSON.parse()
element.setAttribute()
RegExp()
```
## DOM XSS 
###Exemplo
```
+ URL com o parâmetro Search 
https://exemplo.com.br/?search=abcd
```
```
+ Javascript dentro do HTML
+ O payload é armazenado na função document.write (Sink) e processado pela função window.location.search (Sink)

<section class=search>
   <form action=/ method=GET>
        <input type=text placeholder='Search the blog' name=search>
             <button type=submit class=button>Search</button>
   </form>
</section>
<script>
   function trackSearch(query) {

//O valor inserido no parâmetro Search é armazenado na função document.wirte
   document.write('<img src="/resources/images/tracker.gif?searchTerms='+query+'">');
}
//O valor de Search é processado pela função window.location.search
   var query = (new URLSearchParams(window.location.search)).get('search');
   if(query) {
      trackSearch(query);
   }
</script>
```

